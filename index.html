<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RSASSA-PSS Signature</title>
    <meta name="description" content="RSASSA-PSS Signature Example">

    <!--  RSA Encryption and Decryption -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jsencrypt/2.3.1/jsencrypt.min.js"
        integrity="sha512-zDvrqenA0eFJZCxBsryzUZcvihvNlEXbteMv62yRxdhR4s7K1aaz+LjsRyfk6M+YJLyAJEuuquIAI8I8GgLC8A=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.2.0/crypto-js.min.js"
        integrity="sha512-a+SUDuwNzXDvz4XrIcXHuCf089/iJAoN4lmrXJg18XnduKK6YlDHNRalv4yd1N40OKI80tFidF+rqTFKGPoWFQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <!-- Bootstrap CSS and JS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>

    <!-- my js -->
    <script src="signature.js"></script>
    <script>
        // 발급일자를 현재 날짜로 설정
        window.onload = function () {
            document.getElementById("date").value = new Date().toISOString().substring(0, 10);;
            createJson()
        }
    </script>

</head>

<body class="container my-5">

    <h1 class="mb-4">RSASSA-PSS 디지털 서명</h1>

    <p>인증서에 사용할 RSA 키 쌍을 생성하고, 수료증에 대한 메시지를 생성하고 서명을 생성하고 검증하는 예제입니다.</p>

    <div class="mb-3">
        <button type="button" class="btn btn-primary" onclick="createRSAKeyPair()">Create RSA Key Pair</button>
        <button type="button" class="btn btn-secondary" onclick="downloadRSAKeyPair()">Download RSA Key Pair</button>
    </div>


    <div class="mb-4">
        <label for="privateKey" class="form-label">RSA Private Key (발급자 키)</label>
        <textarea id="privateKey" class="form-control" rows="5" oninput="loadRSAKeyPair()"></textarea>
    </div>

    <div class="mb-4">
        <label for="publicKey" class="form-label">RSA Public Key (검증자 키 ex: 검증페이지)</label>
        <textarea id="publicKey" class="form-control" rows="5" oninput="loadRSAKeyPair()"></textarea>
    </div>

    <form id="messageForm" class="mb-4">
        <div class="mb-3">
            <label for="SerialNumber" class="form-label">Serial Number</label>
            <input type="text" id="SerialNumber" class="form-control" placeholder="2024-0001" oninput="createJson()"
                required>
        </div>

        <div class="mb-3">
            <label for="title" class="form-label">Title</label>
            <input type="text" id="title" class="form-control" oninput="createJson()" placeholder="수료증" required>
        </div>

        <div class="mb-3">
            <label for="content" class="form-label">Content</label>
            <textarea id="content" class="form-control" rows="3" oninput="createJson()"
                placeholder="위 사람은 GDSC DEU에서 열심히 활동하였으므로 이에 대한 수료증을 발급합니다." required></textarea>
        </div>

        <div class="mb-3">
            <label for="date" class="form-label">Date</label>
            <input type="date" id="date" class="form-control" oninput="createJson()" required>
        </div>

        <div class="mb-3">
            <label for="creator" class="form-label">Creator</label>
            <input type="text" id="creator" class="form-control" oninput="createJson()"
                placeholder="GDSC DEU 23-24 Lead 김남주" required>
        </div>
    </form>

    <div class="mb-3">
        <label for="json-body" class="form-label">Json Body</label>
        <textarea id="json-body" class="form-control" rows="5" readonly></textarea>
    </div>

    <div class="mb-3">
        <label for="signature" class="form-label">Signature</label>
        <textarea id="signature" class="form-control" rows="5" readonly></textarea>
    </div>

    <button type="button" class="btn btn-secondary" onclick="verifySignature()">Verify Signature</button>

</body>

</html>